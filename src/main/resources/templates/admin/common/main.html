<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/admin/common/layout}">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>ê´€ë¦¬ì ë©”ì¸ ëŒ€ì‹œë³´ë“œ</title>

	<!-- Fonts -->
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

	<!-- Chart.js -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
	<main layout:fragment="adminContent">
		<main class="page">

			<!-- Shortcuts -->
			<section class="section mt-12" aria-label="ì£¼ìš” ê¸°ëŠ¥ ë°”ë¡œê°€ê¸°">
				<h2 class="section__title">ì£¼ìš” ê¸°ëŠ¥ ë°”ë¡œê°€ê¸°</h2>
				<div class="shortcut-grid">

					<a th:href="@{/admin/product}" class="shortcut">
						<div class="shortcut__icon">
							<span class="material-symbols-outlined" aria-hidden>inventory_2</span>
						</div>
						<p class="shortcut__label">ë³´í—˜ ìƒí’ˆ ë‚´ì—­</p>
						<p class="kpi-card__value" th:text="'íŒë§¤ì¤‘ì¸ ìƒí’ˆ ' + ${sellingCount} + 'ê°œ'"></p>
					</a>

					<a th:href="@{/admin/contract}" class="shortcut">
						<div class="shortcut__icon">
							<span class="material-symbols-outlined" aria-hidden>description</span>
						</div>
						<p class="shortcut__label">ë³´í—˜ ê³„ì•½ ì ‘ìˆ˜</p>
						<p class="kpi-card__value" th:text="'ì ‘ìˆ˜ëœ ê³„ì•½ ' + ${contractsPendingCount} + 'ê±´'"></p>
					</a>

					<a th:href="@{/admin/claim}" class="shortcut">
						<div class="shortcut__icon">
							<span class="material-symbols-outlined" aria-hidden>paid</span>
						</div>
						<p class="shortcut__label">ë³´í—˜ê¸ˆ ì²­êµ¬</p>
						<p class="kpi-card__value" th:text="'ì‹ ê·œ ì²­êµ¬ ' + ${claimsPendingCount} + 'ê±´'"></p>
					</a>

					<a th:href="@{/admin/inquiry}" class="shortcut">
						<div class="shortcut__icon">
							<span class="material-symbols-outlined" aria-hidden>support_agent</span>
						</div>
						<p class="shortcut__label">ê³ ê° ë¬¸ì˜ ë‚´ì—­</p>
					</a>
				</div>
			</section>

			<!-- ğŸ“Š ì´ë²ˆ ë‹¬ ê³„ì•½/ì²­êµ¬ í†µê³„ ê·¸ë˜í”„ -->
			<section class="section mt-12" aria-label="ì´ë²ˆ ë‹¬ ê³„ì•½/ì²­êµ¬ í†µê³„">
				<h2 class="section__title">ì´ë²ˆ ë‹¬ ê³„ì•½ / ì²­êµ¬ í†µê³„</h2>

				<div class="chart-grid">
					<!-- ê³„ì•½ ê·¸ë˜í”„ -->
					<div class="chart-card">
						<h3 class="text-lg font-semibold text-gray-800 mb-3">ê³„ì•½ í˜„í™©</h3>
						<canvas id="contractChart"></canvas>
					</div>

					<!-- ì²­êµ¬ ê·¸ë˜í”„ -->
					<div class="chart-card">
						<h3 class="text-lg font-semibold text-gray-800 mb-3">ì²­êµ¬ í˜„í™©</h3>
						<canvas id="claimChart"></canvas>
					</div>
				</div>
			</section>

			<!-- Recent Activity -->
			<section class="section mt-12" aria-label="ìµœê·¼ í™œë™">
				<h2 class="section__title">ìµœê·¼ í™œë™</h2>
				<div class="table-wrap">
					<table class="table">
						<thead>
							<tr>
								<th scope="col">ì‹œê°„</th>
								<th scope="col">í™œë™</th>
								<th scope="col">ê´€ë¦¬ì</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="log : ${recentActivities}">
								<td th:text="${log.created_at}"></td>
								<td th:text="${log.action_desc}"></td>
								<td th:text="${log.employee_name}" class="bold"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</section>

			<!-- Chart Script -->
			<script th:inline="javascript">
			  document.addEventListener("DOMContentLoaded", function () {
			    const contractStats = /*[[${contractStats}]]*/ {};
			    const claimStats = /*[[${claimStats}]]*/ {};

			    new Chart(document.getElementById("contractChart"), {
			      type: "bar",
			      data: {
			        labels: ["ì‹ ê·œ ê³„ì•½", "í•´ì§€ ê³„ì•½"],
			        datasets: [{
			          label: "ê³„ì•½ ê±´ìˆ˜",
					  data: [contractStats.newContracts, contractStats.endedContracts],
			          backgroundColor: ["rgba(17,115,212,0.7)", "rgba(240,70,70,0.7)"]
			        }]
			      },
			      options: { responsive: true, plugins: { legend: { display: false } } }
			    });

			    new Chart(document.getElementById("claimChart"), {
			      type: "bar",
			      data: {
			        labels: ["ì´ ì²­êµ¬ ê¸ˆì•¡", "ì§€ê¸‰ ì™„ë£Œ ê¸ˆì•¡"],
			        datasets: [{
			          label: "ê¸ˆì•¡ (ë§Œì›)",
			          data: [claimStats.totalAmount, claimStats.approvedAmount],
			          backgroundColor: ["rgba(255,206,86,0.7)", "rgba(75,192,192,0.7)"]
			        }]
			      },
			      options: { responsive: true, plugins: { legend: { display: false } } }
			    });
			  });
			</script>
		</main>
	</main>
</body>

</html>